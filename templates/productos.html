{% extends 'base.html' %}

{% block title %}Lista de Productos{% endblock %}

{% block content %}
<h2 class="text-2xl mb-4 font-semibold">Productos</h2>



<!-- Contenedor principal con diseño de cuadrícula -->
<div class="grid grid-cols-3 gap-6 p-1">
    <!-- Contenedor de formulario para agregar productos (1/3) -->
    <div class="col-span-1 bg-white shadow-md rounded-lg p-4">
        <h2 class="text-2xl font-semibold mb-4">Agregar Producto</h2>
        <form action="{{ url_for('productos.agregar_producto') }}" method="POST" class="mb-6">
            <label class="input input-bordered flex items-center gap-2 mb-2">
                <input type="text" name="nombre" placeholder="Nombre del producto" required class="grow" />
                <i class="bi bi-box-fill h-4 w-4 opacity-70"></i> <!-- Icono de "Nombre" -->
            </label>

            <label class="input input-bordered flex items-center gap-2 mb-2">
                <input type="number" name="costo" placeholder="Precio de costo" required class="grow" />
                <i class="bi bi-cash h-4 w-4 opacity-70"></i> <!-- Icono de "Costo" -->
            </label>

            <label class="input input-bordered flex items-center gap-2 mb-2">
                <input type="number" name="precio" placeholder="Precio del producto" required class="grow" />
                <i class="bi bi-cash h-4 w-4 opacity-70"></i> <!-- Icono de "Precio" -->
            </label>

            <label class="input input-bordered flex items-center gap-2 mb-2">
                <input type="text" id="codigoInput" name="codigo" placeholder="Código de barras" required class="grow" />
                <i class="bi bi-barcode h-4 w-4 opacity-70"></i> <!-- Icono de "Código de barras" -->
            </label>

            <!-- Selección de Marca -->
            <label for="marca_id" class="block mb-1">Marca</label>
            <select name="marca_id" id="marca_id" required class="input input-bordered w-full mb-2">
                {% for marca in marcas %}
                    <option value="{{ marca.id }}">{{ marca.nombre }}</option>
                {% endfor %}
            </select>

            <!-- Selección de Rubro -->
            <label for="rubro_id" class="block mb-1">Rubro</label>
            <select name="rubro_id" id="rubro_id" required class="input input-bordered w-full mb-2">
                {% for rubro in rubros %}
                    <option value="{{ rubro.id }}">{{ rubro.nombre }}</option>
                {% endfor %}
            </select>

            <!-- Selección de Tipo -->
            <label for="tipo_id" class="block mb-1">Tipo</label>
            <select name="tipo_id" id="tipo_id" required class="input input-bordered w-full mb-2">
                {% for tipo in tipos %}
                    <option value="{{ tipo.id }}">{{ tipo.nombre }}</option>
                {% endfor %}
            </select>

            <button type="submit" class="btn btn-primary w-full">Agregar Producto</button>
        </form>
    </div>

    <!-- Contenedor de productos con desplazamiento interno (2/3) -->
    <div class="col-span-2 bg-white shadow-md rounded-lg p-0 h-auto">

        <input type="text" placeholder="Escribe para buscar" class="input w-full max-w-xs" />
        <div class="overflow-x-auto h-[400px]"> <!-- Establece un alto fijo aquí -->
            <table class="table table-xs table-pin-rows table-pin-cols">
                <thead>
                    <tr>
                        <th></th>
                        <td>Código</td>
                        <td>Nombre</td>
                        <td>Costo</td>
                        <td>Precio</td>
                        <td>Stock</td>
                        <td>Acciones</td>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    {% for producto in productos %}
                    <tr class="{% if loop.index is even %}bg-gray-100{% else %}bg-white{% endif %}">
                        <th>{{ loop.index }}</th>
                        <td>{{ producto.codigo1 }}</td>
                        <td>{{ producto.nombre }}</td>
                        <td>${{ producto.costo }}</td>
                        <td>${{ producto.precio }}</td>
                        <td>{{ producto.stock }}</td>
                        <td>
                            <a href="{{ url_for('productos.editar_producto', id=producto.id) }}" class="text-blue-500 hover:underline">Editar</a>
                            <form action="{{ url_for('productos.eliminar_producto', id=producto.id) }}" method='POST' style='display:inline;'>
                                <button type='submit' class='text-red-500 hover:underline ml-4'>Eliminar</button>
                            </form>
                        </td>
                        <!-- Esto puede ser opcional -->
                        <th>{{ loop.index }}</th>
                    </tr>
                    {% endfor %}
                </tbody>
                <tfoot>
                    <tr>
                        <th></th>
                        <td>Código</td>
                        <td>Nombre</td>
                        <td>Costo</td>
                        <td>Precio</td>
                        <td>Stock</td>
                        <th></th>
                    </tr>
                </tfoot>
            </table>
        </div>
    </div>

    <!-- Script para evitar el envío del formulario al presionar 'Enter' en el campo de código -->
    <script>
// Evita el envío del formulario al presionar 'Enter' en el campo de código
document.addEventListener('DOMContentLoaded', function() {
    const codigoField = document.getElementById('codigoInput');
    codigoField.addEventListener('keydown', function(event) {
        if (event.key === 'Enter') {
            event.preventDefault();
        }
    });
});
</script>

{% endblock %}